# docker-compose.yml for claude-yolo
#
# Reference/template only â€” the main bin/claude-yolo script uses docker run
# directly for flexibility with per-strategy images.
#
# For manual use:
#   STRATEGY=rails WORKTREE_PATH=/path/to/project docker compose up

version: '3.8'

services:
  claude-yolo:
    build:
      context: ./strategies/${STRATEGY:-rails}
      dockerfile: Dockerfile
    image: claude-yolo-${STRATEGY:-rails}:latest
    network_mode: host
    stdin_open: true
    tty: true
    working_dir: /workspace
    environment:
      - CHROME_CDP_URL=http://localhost:9222
      - RUBY_VERSION=${RUBY_VERSION:-4.0.1}
      - DB_HOST=localhost
      - DB_USERNAME=postgres
      - DB_PASSWORD=postgres
    volumes:
      - ${WORKTREE_PATH:-.}:/workspace
      - claude-home:/home/claude/.claude
      - node-modules:/workspace/node_modules

volumes:
  claude-home:
  node-modules:
